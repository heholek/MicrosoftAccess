Option Compare Database
Option Explicit


Public Sub AddReference(filename As String)
    RemoveReference filename
    Application.References.AddFromFile filename
End Sub

Public Sub AddReferenceByFile(Name As String, path As String)
    RemoveByName Name
    Application.References.AddFromFile path
End Sub

Public Sub PrintReferences()
Dim r As Reference
    For Each r In Application.References
        Debug.Print r.Name, r.FullPath
    Next
End Sub

Public Function FindReference(Name As String) As Reference
Dim r As Reference

    omObjectFunctions.SetAsNothing r
    For Each r In Application.References
        If InStr(1, r.Name, Name) > 0 Then
            Set FindReference = r
            Exit Function
        End If
        If InStr(1, r.FullPath, Name) > 0 Then
            Set FindReference = r
            Exit Function
        End If
    Next
End Function

Public Sub RemoveReference(filename As String)
Dim r As Reference
    
    Set r = FindReference(filename)
    If omObjectFunctions.NotIsNothing(r) Then
        Application.References.Remove r
    End If
End Sub

Public Sub RemoveReferenceByName(Name As String)
Dim i As Long
Dim r As Reference
    For i = Application.References.Count To 1 Step -1
        Set r = Application.References(i)
        If r.Name = Name Then
            Application.References.Remove r
        End If
    Next
End Sub

Public Sub AddVBIDEReference()
    AddReference "C:\Program Files (x86)\Common Files\Microsoft Shared\VBA\VBA6\VBE6EXT.OLB"
End Sub
Public Sub AddAdoDbReference()
    AddReference "C:\Program Files (x86)\Common Files\System\ado\msado28.tlb"
End Sub