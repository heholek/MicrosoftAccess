Option Compare Database
Option Explicit


Public Sub AddReference(filename As String)
    RemoveReference filename
    Application.References.AddFromFile filename
End Sub

Public Function FindReference(Name As String) As Reference
Dim r As Reference

    omObjectFunctions.SetAsNothing r
    For Each r In Application.References
        If InStr(1, r.Name, Name) > 0 Then
            Set FindReference = r
            Exit Function
        End If
        If InStr(1, r.FullPath, Name) > 0 Then
            Set FindReference = r
            Exit Function
        End If
    Next
End Function
Public Sub RemoveReference(filename As String)
Dim r As Reference
    
    Set r = FindReference(filename)
    If omObjectFunctions.NotIsNothing(r) Then
        Application.References.Remove r
    End If
End Sub
Public Sub AddVBIDEReference()
    AddReference "C:\Program Files (x86)\Common Files\Microsoft Shared\VBA\VBA6\VBE6EXT.OLB"
End Sub
Public Sub AddAdoDbReference()
    AddReference "C:\Program Files (x86)\Common Files\System\ado\msado28.tlb"
End Sub