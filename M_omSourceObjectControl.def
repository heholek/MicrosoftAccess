Attribute VB_GlobalNameSpace = False
Attribute VB_Creatable = False
Attribute VB_PredeclaredId = False
Attribute VB_Exposed = False
Option Compare Database
Option Explicit

Dim rs As New ADODB.Recordset
Public Id As Long

Public Sub Load(soId As Long, cId As Long)

    rs.filter = "omSourceObjectId=" & soId & " AND omControlId=" & cId
    If rs.EOF Then
        rs.AddNew
        rs("omSourceObjectId") = soId
        rs("omControlId") = cId
        rs("CreateDate") = Now
        rs.Update
    End If
    Id = rs("Id")
End Sub

Private Sub Class_Initialize()
    rs.Open "omSourceObjectControls", CurrentProject.Connection, adOpenDynamic, adLockOptimistic
End Sub

Private Sub Class_Terminate()
    rs.Close
    Set rs = Nothing
End Sub