Option Compare Database
Option Explicit
' Code written by Raoul Jacobs
' E. jara@opmaat.be
' Date Craeted : 201112

Public Function Main(Optional linkLocal As Boolean = False) As Integer
Dim FormName As String

    MainUserAuthentication
    'omUserFunctions.UserLock
    omMSAccessFunctions.MinimizeNavigationPane

    'Stop
    FormName = "Flow"
    If NotIsNullOrEmpty(Command()) Then
        If omStringFunctions.ParseValue(Trim(Command()), "OpenScreen") = "magazijn" Then
            FormName = "StockCheck_List"
        End If
    End If
    DoCmd.OpenForm FormName
End Function

Public Sub MainUserAuthentication()
    If Not gUser.LoggedIn Then
        If UseWindowsAuthentication Then
            omUserFunctions.LoginWithWindowsUser True
        ElseIf UseLogin Then
            DoCmd.OpenForm "Login", WindowMode:=acDialog
        End If
    End If
End Sub
Public Function LinkAccessDatabase() As Variant
    omSSMAAConnector.LinkMSAccess False
End Function

Public Function LinkSSMADatabase() As Variant
    omSSMAAConnector.LinkUsingSSMA SavePassword:=True, alwaysUpdate:=True
End Function