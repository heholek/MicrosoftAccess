Option Compare Database
Option Explicit

Public gUser As New omUser
Public Const UseWindowsAuthentication As Boolean = False
Public Const UseLoginForm As Boolean = True

Public Function GetWindowsUserName() As String
    GetWindowsUserName = Environ$("UserName")
End Function
Public Function GetWindowsComputerName() As String
    GetWindowsComputerName = Environ$("computername")
End Function

Public Function LoginWithWindowsUser(Optional addWindowsLogon As Boolean = False)
    Set gUser = New omUser
    gUser.LoginByNameOnly GetWindowsUserName, addWindowsLogon:=True
End Function
Public Function UseWindowsUser()
    Set gUser = New omUser
    gUser.Name = GetWindowsUserName
End Function
Public Sub UserLock()
    If omMSAccessFunctions.FormExists("UserLock") Then
        DoCmd.OpenForm "UserLock", , , , acFormReadOnly, acHidden
    End If
End Sub

Public Sub AuthenticateUser()
    If Not gUser.LoggedIn Then
        If UseWindowsAuthentication Then
            omUserFunctions.LoginWithWindowsUser True
        ElseIf UseLoginForm Then
            DoCmd.OpenForm "Login", windowMode:=acDialog
        End If
    End If
End Sub